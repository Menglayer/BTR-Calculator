<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bitlayer ç©ºæŠ•è®¡ç®—å™¨</title>
  <meta name="theme-color" content="#0B0F14" />
  <link rel="icon" href="./assets/logo.png">
  <style>
    :root {
      --bg: #0B0F14;
      --card: rgba(255,255,255,0.05);
      --border: rgba(255,255,255,0.10);
      --text: #e6edf3;
      --muted: rgba(255,255,255,0.65);
      --accent: #F47D1F;
      --accent2: #FFC78A;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: #fff;
      line-height: 1.6;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, "Helvetica Neue", Arial, "Noto Sans", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif;
    }
    .container { max-width: 1120px; margin: 0 auto; padding: 24px 16px 64px; }
    .header { display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    .brand { display: flex; align-items: center; gap: 12px; }
    .brand-logo { width: 42px; height: 42px; border-radius: 9999px; border: 1px solid var(--border); box-shadow: 0 8px 30px rgba(244,125,31,0.2); }
    h1 { margin: 0; font-size: 28px; letter-spacing: 0.2px; }
    .sub { color: var(--muted); margin-top: 2px; font-size: 14px; }
    .btn { background: transparent; border: 1px solid var(--border); color: #fff; padding: 10px 14px; border-radius: 12px; cursor: pointer; }
    .btn:hover { background: rgba(255,255,255,0.07); }
    .grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 24px; }
    @media (min-width: 900px) { .grid { grid-template-columns: 1fr 1fr; } }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 18px; padding: 16px; }
    .label { font-size: 13px; color: rgba(255,255,255,0.85); font-weight: 600; }
    .tooltip { font-size: 12px; color: rgba(255,255,255,0.55); margin-top: 2px; }
    .row { display: flex; align-items: center; justify-content: space-between; gap: 14px; margin: 12px 0; }
    .row input[type="number"] { width: 230px; max-width: 100%; background: rgba(0,0,0,0.35); border: 1px solid var(--border); color: #fff; border-radius: 12px; padding: 10px 12px; font-size: 14px; outline: none; }
    .row input[type="number"]:focus { border-color: #F47D1F88; box-shadow: 0 0 0 3px rgba(244,125,31,0.25); }
    .suffix { margin-left: 6px; font-size: 13px; color: rgba(255,255,255,0.7); }
    .section-title { color: rgba(255,255,255,0.7); font-size: 13px; margin-bottom: 8px; }
    .big { color: var(--accent); font-size: 28px; font-weight: 800; letter-spacing: .2px; }
    .stats { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 12px; }
    @media (min-width: 600px) { .stats { grid-template-columns: repeat(3, 1fr); } }
    .stat { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 12px; }
    .stat .title { font-size: 12px; color: rgba(255,255,255,0.6); }
    .stat .value { margin-top: 6px; font-weight: 700; color: var(--accent); }
    .stat .hint { margin-top: 4px; font-size: 12px; color: rgba(255,255,255,0.55); }
    .two { display: grid; grid-template-columns: 1fr; gap: 12px; }
    @media (min-width: 600px) { .two { grid-template-columns: 1fr 1fr; } }
    .footer-note { font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 8px; }
    .controls { display: flex; gap: 8px; }
    .hidden { display: none; }
    .glow { position: fixed; left: 50%; bottom: -120px; transform: translateX(-50%); width: 760px; height: 220px; background: radial-gradient(60% 60% at 50% 40%, rgba(244,125,31,0.3), transparent 70%); filter: blur(48px); opacity: .45; pointer-events: none; }
    /* Gate overlay */
    #right-col { position: relative; }
    #gate { position: absolute; inset: 0; display: none; align-items: center; justify-content: center; padding: 20px; }
    #gate.active { display: flex; }
    .gate-box { max-width: 560px; width: 100%; background: rgba(9,12,18,0.9); border: 1px solid var(--border); border-radius: 16px; padding: 18px; text-align: center; backdrop-filter: blur(6px); }
    .gate-title { font-weight: 800; font-size: 18px; margin-bottom: 6px; }
    .gate-desc { color: var(--muted); font-size: 14px; }
    .gate-actions { margin-top: 14px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
    .btn-primary { background: linear-gradient(135deg,#F47D1F,#FFC78A); border: none; color: #1d1d1d; font-weight: 700; }
    .btn-primary:hover { filter: brightness(1.05); }
    .blurred { filter: blur(5px); pointer-events: none; user-select: none; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <img class="brand-logo" src="./assets/logo.png" alt="Logo" />
        <div>
          <h1>Bitlayer ç©ºæŠ•è®¡ç®—å™¨</h1>
          <div class="sub">BTR ç©ºæŠ•æ”¶ç›Šä¼°ç®—</div>
        </div>
      </div>
      <div class="controls">
        <button id="btn-advanced" class="btn">é«˜çº§è®¾ç½®</button>
        <button id="btn-reset" class="btn">é‡ç½®</button>
      </div>
    </div>

    <div class="grid">
      <div>
        <div class="card">
          <div class="row">
            <div>
              <div class="label">å®çŸ³æ•°é‡</div>
              <div class="tooltip">æŒ‰ <span id="hint-gemprice"></span> / é¢— è®¡ä»·ï¼ˆå¯åœ¨é«˜çº§è®¾ç½®ä¿®æ”¹ï¼‰</div>
            </div>
            <div>
              <input id="in-gems" type="number" step="any" min="0" placeholder="0" />
            </div>
          </div>

          <div class="row">
            <div>
              <div class="label">ç§¯åˆ†æ•°é‡</div>
              <div class="tooltip">ä½ è´¦æˆ·å½“å‰çš„ç§¯åˆ†</div>
            </div>
            <div>
              <input id="in-points" type="number" step="any" min="0" placeholder="0" />
            </div>
          </div>

          <div class="row">
            <div>
              <div class="label">BTR æ•°é‡</div>
              <div class="tooltip">ç”¨äºå‚ä¸æˆ–é”ä»“çš„ BTRï¼ˆä»…ç”¨äº BTR å¥–åŠ±æ± åˆ†é…ï¼‰</div>
            </div>
            <div>
              <input id="in-btr" type="number" step="any" min="0" placeholder="0" />
            </div>
          </div>

          <div class="row">
            <div>
              <div class="label">èµ›è½¦å¥–åŠ±</div>
              <div class="tooltip">ç›´æ¥è¾“å…¥ä½ æ‹¿åˆ°çš„èµ›è½¦å¥–åŠ±ï¼ˆUSDï¼‰</div>
            </div>
            <div>
              <input id="in-raceusd" type="number" step="any" min="0" placeholder="0" />
              <span class="suffix">USD</span>
            </div>
          </div>
        </div>

        <div id="advanced" class="card hidden">
          <div class="label" style="color:var(--accent);">é«˜çº§è®¾ç½®</div>

          <div class="row">
            <div>
              <div class="label">TGE FDV</div>
              <div class="tooltip">å•ä½ï¼šUSD</div>
            </div>
            <div><input id="in-fdv" type="number" step="any" min="0" /></div>
          </div>

          <div class="row">
            <div>
              <div class="label">ç©ºæŠ•æ¯”ä¾‹</div>
              <div class="tooltip">ç©ºæŠ•æ€»é¢å  FDV çš„ç™¾åˆ†æ¯”</div>
            </div>
            <div>
              <input id="in-airdropPct" type="number" step="0.1" min="0" max="100" />
              <span class="suffix">%</span>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="label">å…¨ç½‘ç§¯åˆ†æ€»é‡</div>
              <div class="tooltip">é»˜è®¤ 4.85 äº¿</div>
            </div>
            <div><input id="in-totalPoints" type="number" step="any" min="0" /></div>
          </div>

          <div class="row">
            <div>
              <div class="label">å®çŸ³å•ä»·</div>
              <div class="tooltip">é»˜è®¤ 0.0025 USD/é¢—</div>
            </div>
            <div><input id="in-gemPrice" type="number" step="any" min="0" /></div>
          </div>

          <div class="two">
            <div class="row">
              <div>
                <div class="label">ç§¯åˆ†æ± æƒé‡</div>
                <div class="tooltip">ä¸‰æ± åˆ†é…ï¼šç§¯åˆ†</div>
              </div>
              <div>
                <input id="in-poolPoints" type="number" step="any" min="0" />
                <span class="suffix">%</span>
              </div>
            </div>

            <div class="row">
              <div>
                <div class="label">BTR æ± æƒé‡</div>
                <div class="tooltip">ä¸‰æ± åˆ†é…ï¼šBTR</div>
              </div>
              <div>
                <input id="in-poolBtr" type="number" step="any" min="0" />
                <span class="suffix">%</span>
              </div>
            </div>

            <div class="row">
              <div>
                <div class="label">èµ›è½¦æ± æƒé‡</div>
                <div class="tooltip">ä¸‰æ± åˆ†é…ï¼šèµ›è½¦ï¼ˆä¿¡æ¯å±•ç¤ºç”¨ï¼Œä¸ªäººèµ›è½¦å¥–åŠ±æŒ‰ USD ç›´æ¥è¾“å…¥ï¼‰</div>
              </div>
              <div>
                <input id="in-poolRace" type="number" step="any" min="0" />
                <span class="suffix">%</span>
              </div>
            </div>
          </div>

          <div class="row">
            <div>
              <div class="label">å…¨ç½‘ BTR å‚ä¸é‡</div>
              <div class="tooltip">ç”¨äºè®¡ç®—ä½ åœ¨ BTR å¥–åŠ±æ± ä¸­çš„å æ¯”</div>
            </div>
            <div><input id="in-globalBtr" type="number" step="any" min="0" /></div>
          </div>

          <div class="tooltip">è¯´æ˜ï¼šä¸‰æ± æƒé‡ä¼šè‡ªåŠ¨å½’ä¸€åŒ–ï¼ˆä¸å¿…ç²¾ç¡®ç­‰äº 100%ï¼‰ã€‚</div>
        </div>
      </div>

      <div id="right-col">
        <div id="results-area">
          <div class="card">
            <div class="section-title">æ€»ç©ºæŠ•æ± ï¼ˆä¼°å€¼ï¼‰</div>
            <div id="out-airdropPoolUSD" class="big">$0.00</div>

            <div class="stats">
              <div class="stat">
                <div class="title">ç§¯åˆ†æ± </div>
                <div id="out-pointsPoolUSD" class="value">$0.00</div>
                <div id="hint-weightP" class="hint">æƒé‡ 0%</div>
              </div>
              <div class="stat">
                <div class="title">BTR æ± </div>
                <div id="out-btrPoolUSD" class="value">$0.00</div>
                <div id="hint-weightB" class="hint">æƒé‡ 0%</div>
              </div>
              <div class="stat">
                <div class="title">èµ›è½¦æ± </div>
                <div id="out-racePoolUSD" class="value">$0.00</div>
                <div id="hint-weightR" class="hint">æƒé‡ 0%</div>
              </div>
            </div>
          </div>

          <div class="two">
            <div class="stat">
              <div class="title">1 ç§¯åˆ†çš„é¢„æµ‹ä»·å€¼</div>
              <div id="out-perPoint" class="value">$0.00</div>
              <div id="hint-fdvpoints" class="hint"></div>
            </div>
            <div class="stat">
              <div class="title">å®çŸ³å•ä»·</div>
              <div id="out-gemPrice" class="value">$0.0025</div>
            </div>
          </div>

          <div class="card">
            <div class="section-title">æˆ‘çš„ç©ºæŠ•ä¼°å€¼</div>
            <div id="out-myTotal" class="big">$0.00</div>

            <div class="stats" style="grid-template-columns: repeat(4, 1fr); gap: 12px;">
              <div class="stat">
                <div class="title">ç§¯åˆ†è´¡çŒ®</div>
                <div id="out-myPoints" class="value">$0.00</div>
              </div>
              <div class="stat">
                <div class="title">BTR è´¡çŒ®</div>
                <div id="out-myBtr" class="value">$0.00</div>
                <div id="hint-btrshare" class="hint"></div>
              </div>
              <div class="stat">
                <div class="title">èµ›è½¦è´¡çŒ®</div>
                <div id="out-myRace" class="value">$0.00</div>
                <div id="hint-race" class="hint"></div>
              </div>
              <div class="stat">
                <div class="title">å®çŸ³ä»·å€¼</div>
                <div id="out-myGem" class="value">$0.00</div>
                <div id="hint-gems" class="hint"></div>
              </div>
            </div>

            <div class="footer-note">æˆ‘çš„éå®çŸ³ç©ºæŠ•å æ¯”ï¼š<span id="out-airdropShare">0%</span></div>
          </div>

          <div class="footer-note">è¯´æ˜ï¼šæœ¬å·¥å…·åŸºäºå¯è°ƒå‚æ•°è¿›è¡Œä¼°ç®—ï¼Œä»…ä¾›å‚è€ƒï¼Œä¸ä»£è¡¨å®˜æ–¹åˆ†é…ã€‚</div>
        </div>

        <!-- GATE OVERLAY -->
        <div id="gate" class="active">
          <div class="gate-box">
            <div class="gate-title">ğŸ”’ ç»“æœå·²éšè—</div>
            <div class="gate-desc">è¯·å…ˆå…³æ³¨æˆ‘çš„æ¨ç‰¹ <strong>@menglayer</strong>ï¼Œç„¶åç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è§£é”è®¡ç®—ç»“æœã€‚</div>
            <div class="gate-actions">
              <a id="btn-open-x" class="btn btn-primary" href="https://x.com/menglayer" target="_blank" rel="noopener noreferrer">å»å…³æ³¨ @menglayer</a>
              <button id="btn-unlock" class="btn">æˆ‘å·²å…³æ³¨ï¼Œæ˜¾ç¤ºç»“æœ</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="glow"></div>

  <script>
    const $ = (id) => document.getElementById(id);
    const nfUSD2 = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 2 });
    const nfUSD6 = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 6 });
    const nfi0 = new Intl.NumberFormat('en-US');
    function toNum(v){ if(v === null || v === undefined) return 0; const n = Number(String(v).replace(/,/g,'')); return Number.isFinite(n) ? n : 0; }

    const state = {
      gems: 0, points: 0, btr: 0, raceUSD: 0,
      fdv: 150000000, airdropPct: 3, totalPoints: 485000000, gemPrice: 0.0025,
      poolPoints: 10, poolBtr: 75, poolRace: 15, globalBtr: 30000000,
    };

    const inputs = {
      gems: $('in-gems'), points: $('in-points'), btr: $('in-btr'), raceUSD: $('in-raceusd'),
      fdv: $('in-fdv'), airdropPct: $('in-airdropPct'), totalPoints: $('in-totalPoints'),
      gemPrice: $('in-gemPrice'), poolPoints: $('in-poolPoints'), poolBtr: $('in-poolBtr'),
      poolRace: $('in-poolRace'), globalBtr: $('in-globalBtr'),
    };

    function syncUI(){
      inputs.fdv.value = state.fdv;
      inputs.airdropPct.value = state.airdropPct;
      inputs.totalPoints.value = state.totalPoints;
      inputs.gemPrice.value = state.gemPrice;
      inputs.poolPoints.value = state.poolPoints;
      inputs.poolBtr.value = state.poolBtr;
      inputs.poolRace.value = state.poolRace;
      inputs.globalBtr.value = state.globalBtr;
      $('out-gemPrice').textContent = nfUSD6.format(state.gemPrice);
      $('hint-gemprice').textContent = nfUSD6.format(state.gemPrice);
    }

    function recalc(){
      state.gems = toNum(inputs.gems.value);
      state.points = toNum(inputs.points.value);
      state.btr = toNum(inputs.btr.value);
      state.raceUSD = Math.max(0, toNum(inputs.raceUSD.value));

      state.fdv = toNum(inputs.fdv.value);
      state.airdropPct = toNum(inputs.airdropPct.value);
      state.totalPoints = toNum(inputs.totalPoints.value);
      state.gemPrice = toNum(inputs.gemPrice.value);
      state.poolPoints = toNum(inputs.poolPoints.value);
      state.poolBtr = toNum(inputs.poolBtr.value);
      state.poolRace = toNum(inputs.poolRace.value);
      state.globalBtr = toNum(inputs.globalBtr.value);

      const airdropPoolUSD = state.fdv * (state.airdropPct/100);
      const sum = (state.poolPoints + state.poolBtr + state.poolRace) || 1;
      const wP = state.poolPoints / sum;
      const wB = state.poolBtr / sum;
      const wR = state.poolRace / sum;

      const pointsPoolUSD = airdropPoolUSD * wP;
      const btrPoolUSD = airdropPoolUSD * wB;
      const racePoolUSD = airdropPoolUSD * wR;

      const perPointUSD = state.totalPoints > 0 ? pointsPoolUSD / state.totalPoints : 0;

      const myPointsUSD = state.points * perPointUSD;
      const myBtrShare = state.globalBtr > 0 ? state.btr / state.globalBtr : 0;
      const myBtrUSD = btrPoolUSD * myBtrShare;
      const myRaceUSD = state.raceUSD; // ç›´æ¥ä»¥ USD è¾“å…¥
      const myGemUSD = state.gems * state.gemPrice;

      const myTotalUSD = myPointsUSD + myBtrUSD + myRaceUSD + myGemUSD;
      const myAirdropShare = airdropPoolUSD>0 ? (myPointsUSD + myBtrUSD + myRaceUSD) / airdropPoolUSD : 0;

      $('out-airdropPoolUSD').textContent = nfUSD2.format(airdropPoolUSD);
      $('out-pointsPoolUSD').textContent = nfUSD2.format(pointsPoolUSD);
      $('out-btrPoolUSD').textContent = nfUSD2.format(btrPoolUSD);
      $('out-racePoolUSD').textContent = nfUSD2.format(racePoolUSD);

      $('hint-weightP').textContent = 'æƒé‡ ' + (wP*100).toFixed(1) + '%';
      $('hint-weightB').textContent = 'æƒé‡ ' + (wB*100).toFixed(1) + '%';
      $('hint-weightR').textContent = 'æƒé‡ ' + (wR*100).toFixed(1) + '%';

      $('out-perPoint').textContent = nfUSD2.format(perPointUSD);
      $('hint-fdvpoints').textContent = 'FDV ' + nfUSD2.format(state.fdv) + ' Â· ç§¯åˆ†æ€»é‡ ' + nfi0.format(state.totalPoints);

      $('out-myPoints').textContent = nfUSD2.format(myPointsUSD);
      $('out-myBtr').textContent = nfUSD2.format(myBtrUSD);
      $('out-myRace').textContent = nfUSD2.format(myRaceUSD);
      $('out-myGem').textContent = nfUSD2.format(myGemUSD);
      $('out-myTotal').textContent = nfUSD2.format(myTotalUSD);

      $('out-airdropShare').textContent = (myAirdropShare*100).toFixed(4) + '%';
      $('hint-btrshare').textContent = state.globalBtr>0 ? ('ä½ çš„å æ¯” ' + (myBtrShare*100).toFixed(4) + '%') : '';
      $('hint-race').textContent = 'é‡‘é¢ ' + nfUSD2.format(state.raceUSD);
      $('hint-gems').textContent = nfi0.format(state.gems) + ' é¢—';
    }

    function bind(){
      Object.values(inputs).forEach(el=>{
        el.addEventListener('input', recalc);
        el.addEventListener('change', recalc);
      });
      $('btn-advanced').addEventListener('click', ()=>{
        const adv = $('advanced');
        adv.classList.toggle('hidden');
        $('btn-advanced').textContent = adv.classList.contains('hidden') ? 'é«˜çº§è®¾ç½®' : 'æ”¶èµ·é«˜çº§è®¾ç½®';
      });
      $('btn-reset').addEventListener('click', ()=>{
        inputs.gems.value = '';
        inputs.points.value = '';
        inputs.btr.value = '';
        inputs.raceUSD.value = '';

        inputs.fdv.value = 150000000;
        inputs.airdropPct.value =3;
        inputs.totalPoints.value = 485000000;
        inputs.gemPrice.value = 0.0025;
        inputs.poolPoints.value = 70;
        inputs.poolBtr.value = 20;
        inputs.poolRace.value = 10;
        inputs.globalBtr.value = 30000000;
        syncUI();
        recalc();
      });

      // Gate
      const gate = $('gate');
      const resultsArea = $('results-area');
      function updateGate(){
        const ok = localStorage.getItem('follow_ok') === '1';
        if(ok){ gate.classList.remove('active'); resultsArea.classList.remove('blurred'); }
        else { gate.classList.add('active'); resultsArea.classList.add('blurred'); }
      }
      updateGate();
      $('btn-unlock').addEventListener('click', ()=>{
        localStorage.setItem('follow_ok','1');
        updateGate();
      });
      $('btn-open-x').addEventListener('click', ()=>{
        // keep gate, user will click unlock after following
      });
    }

    syncUI();
    bind();
    recalc();
  </script>
</body>
</html>
